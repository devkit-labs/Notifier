<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>@devkit-labs/notifier Demo</title>
      <style>
         body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
               sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background: #f8f9fa;
         }
         .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
         }
         .header h1 {
            color: #2c3e50;
            margin: 0 0 10px 0;
         }
         .header p {
            color: #7f8c8d;
            margin: 0;
         }
         button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 6px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            min-width: 150px;
         }
         button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
         }
         button:active {
            transform: translateY(0);
         }

         .success {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
         }
         .error {
            background: linear-gradient(135deg, #ff512f 0%, #f09819 100%);
         }
         .info {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
         }
         .warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
         }
         .message {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
         }

         .section {
            margin: 25px 0;
            padding: 25px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
         }
         .section h2 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.4em;
         }
         .section p {
            color: #7f8c8d;
            margin-bottom: 20px;
         }
         .status {
            margin: 25px 0;
            padding: 20px;
            background: #ecf0f1;
            border-radius: 8px;
            font-family: "Monaco", "Courier New", monospace;
            border-left: 4px solid #3498db;
         }
         .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
         }
         .button-code-pair {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            margin: 15px 0;
            flex-wrap: wrap;
         }
         .button-code-pair button {
            flex: 0 0 auto;
            min-width: 180px;
         }
         .button-code-pair .code-snippet {
            flex: 1;
            min-width: 300px;
            background: #2c3e50;
            color: #ecf0f1;
            padding: 12px 15px;
            border-radius: 8px;
            font-family: "Monaco", "Courier New", monospace;
            font-size: 12px;
            overflow-x: auto;
            white-space: pre;
         }
         .code-sample {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            font-family: "Monaco", "Courier New", monospace;
            font-size: 13px;
            margin: 15px 0;
            overflow-x: auto;
         }
         .code-sample {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            font-family: "Monaco", "Courier New", monospace;
            font-size: 13px;
            margin: 15px 0;
            overflow-x: auto;
         }
      </style>
   </head>
   <body>
      <div class="header">
         <h1>@devkit-labs/notifier</h1>
         <p>
            Lightweight framework agnostic browser notification utility with
            permission handling, clean API, fallbacks, and deduplication out of
            the box
         </p>
      </div>

      <div id="status" class="status">
         <strong>System Status:</strong><br />
         üìã Permission: <span id="permission-status">Loading...</span><br />
         üñ•Ô∏è Browser Support: <span id="notification-support">Loading...</span
         ><br />
         üè∑Ô∏è Tab Visibility: <span id="tab-visibility">Active</span>
      </div>

      <div class="section">
         <h2>üéØ Basic Typed Notifications</h2>
         <p>
            Test the five core notification types with pre-configured styling
            and icons.
         </p>

         <div class="button-code-pair">
            <button class="success" onclick="testSuccess()">‚úÖ Success</button>
            <div class="code-snippet">
               notify.success("Task Completed Successfully!", { body: "Your file
               has been processed and is ready for download.", onclick: () =>
               window.focus(), });
            </div>
         </div>

         <div class="button-code-pair">
            <button class="error" onclick="testError()">‚ùå Error</button>
            <div class="code-snippet">
               notify.error("Upload Failed", { body: "The file could not be
               uploaded. Please check your internet connection.",
               requireInteraction: true, onclick: () => alert("Redirecting to
               help page..."), });
            </div>
         </div>

         <div class="button-code-pair">
            <button class="info" onclick="testInfo()">‚ÑπÔ∏è Info</button>
            <div class="code-snippet">
               notify.info("New Feature Available", { body: "Version 2.0 is now
               available with exciting new features!", onclick: () =>
               window.open("https://github.com/devkit-labs/notifier", "_blank"),
               });
            </div>
         </div>

         <div class="button-code-pair">
            <button class="warning" onclick="testWarning()">‚ö†Ô∏è Warning</button>
            <div class="code-snippet">
               notify.warning("Storage Almost Full", { body: "You have used 90%
               of your storage space. Consider cleaning up old files.", onclick:
               () => alert("Opening storage management..."), });
            </div>
         </div>

         <div class="button-code-pair">
            <button class="message" onclick="testMessage()">üí¨ Message</button>
            <div class="code-snippet">
               notify.message("Meeting Reminder", { body: "Daily standup meeting
               starts in 5 minutes.", onclick: () => window.focus(), });
            </div>
         </div>
      </div>

      <div class="section">
         <h2>üé® Rich Notifications</h2>
         <p>
            Advanced notifications with images, badges, interaction
            requirements, and event handlers.
         </p>

         <div class="button-code-pair">
            <button onclick="testRichNotification()">
               üñºÔ∏è Rich Notification
            </button>
            <div class="code-snippet">
               notify.error("File Processing Error", { body: "The uploaded file
               could not be processed due to format issues.", badge:
               "data:image/svg+xml,...", image: "data:image/svg+xml,...",
               requireInteraction: true, vibrate: [200, 100, 200, 100, 200],
               data: { fileId: "12345", errorCode: "FORMAT_ERROR" }, onclick: ()
               => alert("Opening error details..."), });
            </div>
         </div>

         <div class="button-code-pair">
            <button onclick="testPersistentNotification()">
               üìå Persistent Notification
            </button>
            <div class="code-snippet">
               notify.warning("Important System Update", { body: "A critical
               security update is available. Please restart your application.",
               requireInteraction: true, onclick: () => { if (confirm("Restart
               application now?")) { location.reload(); } }, });
            </div>
         </div>

         <div class="button-code-pair">
            <button onclick="testSilentNotification()">
               üîá Silent Notification
            </button>
            <div class="code-snippet">
               notify.info("Background Sync Complete", { body: "Your data has
               been synchronized with the server.", silent: true, onclick: () =>
               console.log("Silent notification clicked!"), });
            </div>
         </div>

         <div class="button-code-pair">
            <button onclick="testFullMediaNotification()">
               üé• Full Media Notification
            </button>
            <div class="code-snippet">
               notify.success("Video Processing Complete", { body: "Your video
               has been successfully processed and is ready for viewing.",
               badge: "data:image/svg+xml,...", image: "data:image/svg+xml,...",
               vibrate: [100, 50, 100], data: { videoId: "vid_12345", duration:
               "5:32", quality: "1080p" }, onclick: () => alert("Opening video
               player..."), });
            </div>
         </div>
      </div>

      <div class="section">
         <h2>üö´ Permission Fallback Testing</h2>
         <p>
            See how the library handles blocked notifications with beep
            fallbacks.
         </p>
         <p>
            <small
               >üí° To test fallbacks, block notifications in your browser
               settings.</small
            >
         </p>

         <div class="button-code-pair">
            <button onclick="testPermissionFallback()">üîî Test Fallback</button>
            <div class="code-snippet">
               notify.error("Test Fallback Behavior", { body: "If notifications
               are blocked, this will trigger beep sound.", onclick: () =>
               console.log("Fallback test clicked!"), });
            </div>
         </div>

         <div class="button-code-pair">
            <button onclick="testSilentFallback()">üîá Silent Fallback</button>
            <div class="code-snippet">
               notify.info("Silent Fallback Test", { body: "This fallback won't
               play a beep sound due to the silent flag.", silent: true,
               onclick: () => console.log("Silent fallback clicked!"), });
            </div>
         </div>
      </div>

      <script src="https://unpkg.com/@devkit-labs/notifier@latest/dist/index.global.js"></script>
      <script>
         const {
            notifier,
            notify,
            getPermissionStatus,
            isNotificationSupported,
         } = NotifierLib;

         // Initialize with comprehensive configuration
         notifier.init({
            showOnSourceTab: true,
            onPermissionDeny: () => {
               console.log(
                  "Permission denied! User can be redirected or shown custom UI"
               );
               // You can show custom UI, redirect user, or handle as needed
               // Example: show a subtle notification in your app's notification area
            },
         });

         // Track tab visibility
         document.addEventListener("visibilitychange", () => {
            document.getElementById("tab-visibility").textContent =
               document.hidden ? "Hidden" : "Active";
         });

         // Update status display
         function updateStatus() {
            document.getElementById("permission-status").textContent =
               getPermissionStatus();
            document.getElementById("notification-support").textContent =
               isNotificationSupported() ? "Yes" : "No";
         }

         // Basic notification tests
         async function testSuccess() {
            notify.success("Task Completed Successfully!", {
               body: "Your file has been processed and is ready for download.",
               onclick: () => {
                  console.log("Success notification clicked!");
                  window.focus();
               },
            });
         }

         async function testError() {
            notify.error("Upload Failed", {
               body: "The file could not be uploaded. Please check your internet connection and try again.",
               requireInteraction: true,
               onclick: () => {
                  console.log("Error notification clicked!");
                  alert("Redirecting to help page...");
               },
            });
         }

         async function testInfo() {
            notify.info("New Feature Available", {
               body: "Version 2.0 is now available with exciting new features including dark mode and advanced analytics!",
               onclick: () => {
                  console.log("Info notification clicked!");
                  window.open(
                     "https://github.com/devkit-labs/notifier",
                     "_blank"
                  );
               },
            });
         }

         async function testWarning() {
            notify.warning("Storage Almost Full", {
               body: "You have used 90% of your storage space. Consider cleaning up old files.",
               onclick: () => {
                  console.log("Warning notification clicked!");
                  alert("Opening storage management...");
               },
            });
         }

         async function testMessage() {
            notify.message("Meeting Reminder", {
               body: "Daily standup meeting starts in 5 minutes. Don't forget to prepare your updates!",
               onclick: () => {
                  console.log("Message notification clicked!");
                  window.focus();
               },
            });
         }

         // Rich notifications
         async function testRichNotification() {
            notify.error("File Processing Error", {
               body: "The uploaded file could not be processed due to format issues.",
               badge: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="red"><circle cx="12" cy="12" r="10"/></svg>',
               image: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 100" fill="none"><rect width="200" height="100" fill="%23f8f9fa"/><text x="100" y="55" text-anchor="middle" fill="%23666" font-family="Arial" font-size="14">Error Preview Image</text></svg>',
               requireInteraction: true,
               vibrate: [200, 100, 200, 100, 200],
               data: { fileId: "12345", errorCode: "FORMAT_ERROR" },
               onclick: () => {
                  console.log("Rich notification clicked!");
                  alert("Opening error details...");
               },
               onclose: () => {
                  console.log("Rich notification was closed");
               },
            });
         }

         async function testPersistentNotification() {
            notify.warning("Important System Update", {
               body: "A critical security update is available. Please restart your application to apply the update.",
               requireInteraction: true,
               onclick: () => {
                  console.log("Persistent notification clicked!");
                  if (confirm("Restart application now?")) {
                     location.reload();
                  }
               },
            });
         }

         async function testSilentNotification() {
            notify.info("Background Sync Complete", {
               body: "Your data has been synchronized with the server.",
               silent: true,
               onclick: () => {
                  console.log("Silent notification clicked!");
               },
            });
         }

         async function testFullMediaNotification() {
            notify.success("Video Processing Complete", {
               body: "Your video has been successfully processed and is ready for viewing.",
               badge: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="green"><path d="M8 5v14l11-7z"/></svg>',
               image: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 150" fill="none"><rect width="300" height="150" fill="%23000"/><polygon points="120,50 120,100 180,75" fill="white"/><text x="150" y="130" text-anchor="middle" fill="white" font-family="Arial" font-size="12">Video Preview</text></svg>',
               requireInteraction: false,
               vibrate: [100, 50, 100],
               data: {
                  videoId: "vid_12345",
                  duration: "5:32",
                  quality: "1080p",
               },
               onclick: () => {
                  console.log("Video notification clicked!");
                  alert("Opening video player...");
               },
            });
         }

         // Tab visibility tests
         async function testBackgroundOnly() {
            notify.success("Background Task Complete", {
               body: "This notification only appears when you're viewing another tab. Try switching tabs after clicking this button!",
               showOnSourceTab: false,
               onclick: () => {
                  window.focus();
                  alert("You clicked the background notification!");
               },
            });
         }

         async function testAlwaysShow() {
            notify.info("Always Visible Alert", {
               body: "This notification appears regardless of which tab you're viewing.",
               showOnSourceTab: true,
               onclick: () => {
                  console.log("Always-show notification clicked!");
               },
            });
         }

         async function testVisibilityDemo() {
            const isHidden = document.hidden;
            notify.message("Tab Visibility Demo", {
               body: `This tab is currently ${
                  isHidden ? "hidden" : "visible"
               }. The notification behavior adapts accordingly.`,
               onclick: () => {
                  console.log(
                     `Visibility demo clicked! Tab was ${
                        isHidden ? "hidden" : "visible"
                     }`
                  );
               },
            });
         }

         // Permission fallback tests
         async function testPermissionFallback() {
            notify.error("Test Fallback Behavior", {
               body: "If notifications are blocked, this will trigger a beep sound.",
               onclick: () => {
                  console.log("Fallback test clicked!");
               },
            });
         }

         async function testSilentFallback() {
            notify.info("Silent Fallback Test", {
               body: "This fallback won't play a beep sound due to the silent flag.",
               silent: true,
               onclick: () => {
                  console.log("Silent fallback clicked!");
               },
            });
         }

         async function simulateBlockedPermission() {
            // Temporarily override Notification to simulate blocked permission
            const originalNotification = window.Notification;
            window.Notification = { permission: "denied" };

            notify.warning("Simulated Blocked Notification", {
               body: "This demonstrates the beep fallback when notifications are blocked.",
            });

            // Restore original Notification
            window.Notification = originalNotification;
            updateStatus();
         }

         // Real-world examples
         async function simulateFileUpload() {
            // Simulate upload progress
            notify.info("Upload Started", {
               body: "Beginning file upload...",
               silent: true,
            });

            // Simulate completion after delay
            setTimeout(async () => {
               notify.success("Upload Complete", {
                  body: "document.pdf has been uploaded successfully.",
                  requireInteraction: false,
                  onclick: () => {
                     alert("Opening file manager...");
                  },
               });
            }, 2000);
         }

         async function simulateSystemWarning() {
            notify.warning("System Resource Alert", {
               body: "CPU usage is at 85%. Some applications may run slower than usual.",
               requireInteraction: true,
               onclick: () => {
                  alert("Opening task manager...");
               },
            });
         }

         async function simulateSessionExpiry() {
            notify.info("Session Expiring Soon", {
               body: "Your session will expire in 5 minutes. Save your work to avoid losing changes.",
               requireInteraction: true,
               onclick: () => {
                  if (confirm("Extend session for another hour?")) {
                     notify.success("Session Extended", {
                        body: "Your session has been extended for one hour.",
                     });
                  }
               },
            });
         }

         async function simulateTaskCompletion() {
            notify.success("Data Export Complete", {
               body: "Your report has been generated and is ready for download.",
               badge: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="green"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/></svg>',
               onclick: () => {
                  alert("Downloading report.xlsx...");
               },
            });
         }

         // Utility functions
         async function checkPermissionStatus() {
            const status = getPermissionStatus();
            notify.message("Permission Status", {
               body: `Current notification permission: ${status}`,
               silent: true,
            });
         }

         async function checkBrowserSupport() {
            const supported = isNotificationSupported();
            notify.message("Browser Support", {
               body: `Notifications ${
                  supported ? "are" : "are not"
               } supported in this browser.`,
               silent: true,
            });
         }

         async function requestPermission() {
            if ("Notification" in window) {
               const permission = await Notification.requestPermission();
               updateStatus();
               notify.message("Permission Request", {
                  body: `Permission ${
                     permission === "granted" ? "granted" : "denied"
                  }.`,
                  silent: true,
               });
            }
         }

         // Initial status update
         updateStatus();

         // Welcome message
         setTimeout(() => {
            notify.message("Welcome to the Demo!", {
               body: "Try the different notification types and features. Check your browser's notification settings if needed.",
               onclick: () => {
                  console.log("Welcome notification clicked!");
               },
            });
         }, 1000);
      </script>
   </body>
</html>
